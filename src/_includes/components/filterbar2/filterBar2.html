{% set default_selectClasses = 'p-4 w-full border-0' %}
{% set default_formClasses = '' %}

<div class="overflow-hidden mx-auto rounded-2xl bg-white">
  <form 
  class="" 
  x-cloak
  x-data="{
    selection: {
      subject: '{{ params.data.subject }}' || null,
      grade: '{{ params.data.grade }}' || null,
      area: '{{ params.data.area }}' || null,
    },
    readyToSubmit: true,
    data: {}
  }" 
  x-init="
    fetch('/api/resultsTree.json')
    .then(function(response) { return response.json(); })
    .then(function(response) { data = response; });
  "
  x-on:submit="location = `${data[selection.subject].grades[selection.grade].areas[selection.area].url}`; " 
  @submit.prevent
  >
    <select x-model="selection.subject" @change="selection.grade = null; selection.area = null;">
      <option>Choose Subject</option>
      <template 
        x-for="[id, value] in Object.entries(data)" 
        :key="id">
        <option :value="id" :selected="id == selection.subject" x-text="value.name"></option>
      </template>
    </select>

    <select x-model="selection.grade" @change="selection.area = null;" :disabled="!selection.subject">
      <option>Choose Grade</option>
      <template
        x-if="selection.subject !== null">
        <template 
          x-for="[id, value] in Object.entries(data[selection.subject].grades)" 
          :key="id">
          <option :value="id" :selected="id == selection.grade" x-text="value.name"></option>
        </template>
      </template>
    </select>

    <select x-model="selection.area" :disabled="!selection.grade">
      <option>Choose Area</option>
      <template
        x-if="selection.grade !== null">
        <template 
          x-for="[id, value] in Object.entries(data[selection.subject].grades[selection.grade].areas) || []" 
          :key="id">
          <option :value="id" :selected="id == selection.area" x-text="value.name"></option>
        </template>
      </template>
    </select>

    <input type="submit" value="{{ params.submitText if params.submitText else 'Submit' }}" :disabled="!selection.subject && !selection.grade && !selection.area" class="block md:inline-block flex-shrink w-full" />
  </form>
</div>